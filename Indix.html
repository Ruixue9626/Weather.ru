<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤©æ°£é å ±</title>
    <style>
        body {
            margin: 0;
            font-family: Arial, sans-serif;
            display: flex;
            height: 100vh;
        }
        .container {
            display: flex;
            width: 100%;
        }
        .desktop {
            width: 50%;
            background: #87CEEB;
            padding: 20px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .mobile {
            width: 50%;
            background: #87CEEB;
            padding: 20px;
            overflow-y: auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .weather-box {
            text-align: center;
            color: black;
        }
        .weather-box h1 {
            font-size: 2.5em;
            margin: 0;
        }
        .weather-box p {
            margin: 5px 0;
        }
        .search-box {
            margin: 10px 0;
        }
        .search-box input {
            padding: 5px;
            font-size: 1em;
            border: none;
            border-radius: 5px;
        }
        .details {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        .details div {
            text-align: center;
        }
        .emoji {
            font-size: 1.5em;
        }
        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }
            .desktop, .mobile {
                width: 100%;
            }
            .desktop {
                overflow: hidden;
            }
            .mobile {
                overflow-y: auto;
            }
        }
        #history {
            margin-top: 20px;
            text-align: left;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="desktop">
            <div class="weather-box">
                <p>p.m 3:24</p>
                <h1>æ™´ 30.3Â°C</h1>
                <div class="search-box">
                    <input type="text" id="cityInputDesktop" placeholder="æœå°‹: å°åŒ—">
                    <button onclick="fetchWeather('desktop')">æœå°‹</button>
                </div>
                <div class="details">
                    <div>
                        <p class="emoji">ğŸ’§</p>
                        <p>ç›¸å°æ¿•åº¦: 81%</p>
                    </div>
                    <div>
                        <p class="emoji">ğŸŒ¬ï¸</p>
                        <p>é¢¨é€Ÿ: 3ç´š 5 m/s</p>
                    </div>
                    <div>
                        <p class="emoji">ğŸŒ¬ï¸</p>
                        <p>é¢¨å‘: åå—é¢¨</p>
                    </div>
                    <div>
                        <p class="emoji">â˜ï¸</p>
                        <p>é™é›¨æ©Ÿç‡: 10%</p>
                    </div>
                    <div>
                        <p class="emoji">ğŸ˜“</p>
                        <p>èˆ’é©åº¦: æ‚¶ç†±30</p>
                    </div>
                    <div>
                        <p class="emoji">â˜€ï¸</p>
                        <p>æœ€å¤§ç´«å¤–ç·š: II</p>
                    </div>
                </div>
            </div>
            <div id="historyDesktop"></div>
        </div>
        <div class="mobile">
            <div class="weather-box">
                <p>æ™´ 30.3Â°C</p>
                <div class="search-box">
                    <input type="text" id="cityInputMobile" placeholder="æœå°‹: å°åŒ—">
                    <button onclick="fetchWeather('mobile')">æœå°‹</button>
                </div>
                <div class="details">
                    <div>
                        <p class="emoji">ğŸ’§</p>
                        <p>ç›¸å°æ¿•åº¦: 81%</p>
                    </div>
                    <div>
                        <p class="emoji">ğŸŒ¬ï¸</p>
                        <p>é¢¨é€Ÿ: 3ç´š 5 m/s</p>
                    </div>
                    <div>
                        <p class="emoji">ğŸŒ¬ï¸</p>
                        <p>é¢¨å‘: åå—é¢¨</p>
                    </div>
                    <div>
                        <p class="emoji">â˜ï¸</p>
                        <p>é™é›¨æ©Ÿç‡: 10%</p>
                    </div>
                    <div>
                        <p class="emoji">ğŸ˜“</p>
                        <p>èˆ’é©åº¦: æ‚¶ç†±30</p>
                    </div>
                    <div>
                        <p class="emoji">â˜€ï¸</p>
                        <p>æœ€å¤§ç´«å¤–ç·š: II</p>
                    </div>
                </div>
            </div>
            <div id="historyMobile"></div>
        </div>
    </div>

    <script>
        // å‡è¨­çš„ä¸­å¤®æ°£è±¡å±€ API (éœ€æ›¿æ›ç‚ºçœŸå¯¦ API)
        const API_KEY = "CWA-3D40075B-EA31-4D6B-8818-3EE7830B4B8D"; // è«‹å¡«å…¥çœŸå¯¦ API é‡‘é‘°
        const API_URL = "https://api.cwb.gov.tw/v1/rest/datastore/O-A0003-001"; // å‡è¨­çš„ API ç«¯é»

        let history = JSON.parse(localStorage.getItem('weatherHistory')) || [];

        function fetchWeather(device) {
            const cityInput = document.getElementById(`cityInput${device.charAt(0).toUpperCase() + device.slice(1)}`).value;
            if (!cityInput) return;

            // æ¨¡æ“¬ API å‘¼å« (å¯¦éš›éœ€æ ¹æ“š CWB API æ ¼å¼èª¿æ•´)
            const url = `${API_URL}?locationName=${cityInput}&Authorization=${API_KEY}`;
            fetch(url)
                .then(response => response.json())
                .then(data => {
                    // å‡è¨­æ•¸æ“šçµæ§‹ï¼Œæ ¹æ“šå¯¦éš› API èª¿æ•´
                    const weather = data.records.location[0].weatherElement[0];
                    updateWeather(device, {
                        temperature: "30.3",
                        humidity: "81%",
                        windSpeed: "3ç´š 5 m/s",
                        windDirection: "åå—é¢¨",
                        rainChance: "10%",
                        comfort: "æ‚¶ç†±30",
                        uv: "II"
                    });
                    updateHistory(cityInput);
                })
                .catch(error => console.error('Error fetching weather:', error));
        }

        function updateWeather(device, data) {
            const weatherBox = document.querySelector(`.${device} .weather-box`);
            weatherBox.querySelector('h1').textContent = `æ™´ ${data.temperature}Â°C`;
            const details = weatherBox.querySelector('.details');
            details.children[0].querySelector('p:last-child').textContent = `ç›¸å°æ¿•åº¦: ${data.humidity}`;
            details.children[1].querySelector('p:last-child').textContent = `é¢¨é€Ÿ: ${data.windSpeed}`;
            details.children[2].querySelector('p:last-child').textContent = `é¢¨å‘: ${data.windDirection}`;
            details.children[3].querySelector('p:last-child').textContent = `é™é›¨æ©Ÿç‡: ${data.rainChance}`;
            details.children[4].querySelector('p:last-child').textContent = `èˆ’é©åº¦: ${data.comfort}`;
            details.children[5].querySelector('p:last-child').textContent = `æœ€å¤§ç´«å¤–ç·š: ${data.uv}`;
        }

        function updateHistory(city) {
            if (!history.includes(city)) {
                history.push(city);
                localStorage.setItem('weatherHistory', JSON.stringify(history));
                updateHistoryDisplay();
            }
        }

        function updateHistoryDisplay() {
            const historyDesktop = document.getElementById('historyDesktop');
            const historyMobile = document.getElementById('historyMobile');
            historyDesktop.innerHTML = historyMobile.innerHTML = '<h3>æ­·å²ç´€éŒ„:</h3>' + history.map(city => `<p>${city}</p>`).join('');
        }

        // åˆå§‹è¼‰å…¥æ­·å²ç´€éŒ„
        updateHistoryDisplay();
    </script>
</body>
</html>
